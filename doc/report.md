# Lease机制实验

## 对象

### Center
中心节点作为leader存在, 用于维护各个节点的一致性

当有读指令到达时, center会返回对应的数据, 并颁发一个lease, 表示该数据在lease到期前不会改变

当有新的写指令到达时, 新颁发的lease时间不会超过已颁发lease的最大时间, 保证所有lease能在一个最大时间前全部过期

在全部lease过期后, center会把队列中的写指令全部写入更新

### Cache
Cache节点是对中心节点数据的缓存, 会储存数据和对应的lease, 保证在lease过期以后才去向center请求数据, 以保证数据的一致性

### TODO
计划向Center节点添加主动过期机制, 通过向所有cache发送请求, 统计响应数来提前过期lease, 以减少等待lease的时间

需要添加的机制:
- cache节点提供过期接口, 并返回自己的id
- center节点必须维护颁发过lease的节点的全部id

id分配机制采用中心节点分配机制: 接口都带上id识别信息, 如果没有id信息, 则中心节点分配一个新的id给该节点.

